import{s as ie,g as We,w as Ge,c as y,r as t,E as re,a as r,b as R,d as pe,f as o,h as n,i as _,m as d,D as M,n as x,F as me,G as Ke,k as S,l as A,e as j,p as de}from"./index.c91cc030.js";const Je=d(" \u6A19\u6848\u8A08\u756B\u6E05\u55AE "),Qe=d(" \u91CD\u65B0\u586B\u5BEB "),Xe={class:"p-tipSize"},Ye=j("div",{class:"mx-5 mt-2"},[j("div",null,"\u7B2C\u4E00\u6B21\u53D6\u5F97\u5951\u7D04\u7DE8\u865F\uFF0C\u8ACB\u9EDE\u9078[\u53D6\u865F]"),j("div",null,"\u5982\u4EE5\u53D6\u7684\u5951\u7D04\u7DE8\u865F\uFF0C\u4F46\u6709\u8ABF\u6574\u8A08\u756B\uFF0C\u8ACB\u9EDE\u9078[\u53D6\u865F]")],-1),Ze=d("\u53D6\u865F"),$e=d(" \u91CD\u65B0\u586B\u5BEB "),et=d("\u5132\u5B58"),tt=d("\u5132\u5B58 "),at=d("\u5E36\u5165\u8A08\u756B "),ot=d(" \u91CD\u65B0\u586B\u5BEB "),st={__name:"TenderPlanList",setup(nt){const{globalFieldData:g,api:P,cf:ce,cc:H,_:W,formRules:b,naiveUi:fe}=ie(We()),{windowInnerHeight:q,isLoading:G}=ie(Ge()),V=y(()=>q.value*.68+"px"),ve=y(()=>q.value*.95+"px"),c=fe.value.useMessage(),h=t(!1),v=t(""),ye=y(()=>q.value*.5+"px"),O=t(!1),K=t([]),l=t([{label:"test1",value:"1"},{label:"test2",value:"2"},{label:"test3",value:"3"}]),k=re({page:1,pageCount:1,pageSize:25,onChange:s=>{O.value=!0,u.value.currentPage=s,D(!0)}}),J=t(null),ke={},Q=t([]),u=t({currentPage:k.page,pages:k.pageSize});Q.value=b.value.createFormRules(ke,u);const ge=t([{option:"btn",showLabel:!1,showFeedback:!1,style:{"margin-bottom":"0.75rem"},span:24,btnObject:[{name:"\u532F\u51FAExcel",type:"excel",onClick:()=>{u.value={}}},{name:"\u65B0\u589E\u6A19\u6848\u8A08\u756B",type:"add",onClick:()=>{v.value="new",Y(),h.value=!0}}]},{name:"\u5E74\u5EA6",span:3,option:"select",key:"year",filter:!0,optionsList:y(()=>g.value.yearOptions)},{name:"\u7D44\u5BA4",span:5,option:"select",selectMultiple:!0,filter:!0,optionsList:y(()=>g.value.ministryCode),key:"groupCode"},{name:"\u5951\u7D04\u7DE8\u865F",option:"input",key:"projkey"},{name:"\u9810\u7B97\u4F86\u6E90\u5225",option:"select",key:"budgetSourceCode",filter:!0,optionsList:y(()=>g.value.bsCode)},{name:"\u6A19\u6848\u540D\u7A31",option:"input",key:"tenderChName"},{option:"btnTip",btnObject:[{name:"\u67E5\u8A62",type:"search",onClick:()=>{O.value=!0,u.value.currentPage=1,D(!0)}},{name:"\u6E05\u7A7A",type:"clear",onClick:()=>{u.value.year="",u.value.projkey="",u.value.groupCode=[],u.value.budgetSourceCode="",u.value.tenderChName="",k.page=1,u.value.currentPage=1}}]}]),D=s=>{P.value.queryTenderData(u.value).then(e=>{e.status==200?(s&&c.success("\u67E5\u8A62\u6210\u529F"),K.value=e.data.lists,k.page=e.data.currentPage,k.pageCount=e.data.totalPage,k.pageRows=e.data.totalRows):s&&c.error("\u67E5\u8A62\u5931\u6557"),O.value=!1})},be=t([{title:"\u5E74\u5EA6",width:"8%",key:"year"},{title:"\u5951\u7D04\u7DE8\u865F",width:"15%",key:"projkey"},{title:"\u6A19\u6848\u540D\u7A31",key:"tenderChName"},{title:"\u63A1\u8CFC\u65B9\u5F0F",key:"valuationCode",render(s){return ce.value.getCodeData(g.value,"vaCode",s.valuationCode).label}},{title:"\u4F5C\u696D",width:"19%",key:"actions",render:(s,e)=>[de(H.value.commonBtn,{style:{marginRight:"8px"},type:"edit",onClick:()=>{G.value=!0,P.value.getTenderData({id:s.id}).then(i=>{i.status==200?(c.success("\u67E5\u8A62\u6210\u529F"),v.value="edit",h.value=!0,W.value.forEach(i.data[0],(m,U)=>{p.value[U]=m})):c.error("\u67E5\u8A62\u5931\u6557")})}},{default:()=>"\u4FEE\u6539"}),de(H.value.commonBtn,{type:"delete",onclick:()=>{}},{default:()=>"\u522A\u9664"})]}]),z=t(null),he={tenderChname:"req",year:"req",plansubId:"req",planId:"req"},X=t([]),p=t({tenderChname:"",year:"",plansubId:"",planId:""});X.value=b.value.createFormRules(he,p);const Y=()=>{const s=[];W.value.forEach(p.value,(e,i)=>{s.find(m=>m==i)==null&&(p.value[i]="")})},Re=()=>{var s;(s=z.value)==null||s.validate(e=>{e?c.error("\u9A57\u8B49\u5931\u6557"):(G.value=!0,v.value=="new"?P.value.createTenderData(p.value).then(i=>{i.status==201?(c.success("\u65B0\u589E\u6210\u529F"),D(),h.value=!1):c.error("\u65B0\u589E\u5931\u6557")}):P.value.updateTenderData(p.value).then(i=>{i.status==200?(c.success("\u66F4\u65B0\u6210\u529F"),D(),h.value=!1):c.error("\u66F4\u65B0\u5931\u6557")}))})},_e=()=>{Y()},C=t(!1),Ce=t([{name:"\u5E74\u5EA6 : ",option:"select",key:"year",filter:!0,optionsList:y(()=>g.value.yearOptions)},{name:"\u6A19\u6848\u540D\u7A31 : ",option:"input",key:"tenderChname"},{name:"\u6A19\u6848\u82F1\u6587\u540D\u7A31 : ",option:"input",key:"tenderEnname"},{name:"\u627F\u8FA6\u4EBA : ",option:"select",key:"officer",optionsList:l,filter:!0},{name:"\u627F\u8FA6\u4EBA\u96FB\u8A71 : ",option:"input",key:"tel"},{name:"\u9078\u64C7\u5207\u5272\u7D93\u8CBB : ",option:"select",key:"plancostcuttingId",optionsList:l,filter:!0},{name:"\u4E3B\u8981\u7DB1\u8981\u8A08\u756B\u540D\u7A31 : ",option:"select",key:"planId",optionsList:l,filter:!0},{name:"\u5B50\u7DB1\u8981\u8A08\u756B\u540D\u7A31 : ",option:"select",key:"plansubId",selectMultiple:!0,filter:!0,optionsList:l},{name:"\u524D\u671F\u6A19\u6848\u8A08\u756B : ",option:"input",key:"oldTenderId",span:18},{option:"btnTip",span:6,style:{"margin-left":"8px"},btnObject:[{name:"\u67E5\u8A62",type:"search",onClick:()=>{C.value=!C.value}},{name:"\u6E05\u7A7A",type:"clear",onClick:()=>{}}]},{name:"\u63A1\u8CFC\u65B9\u5F0F : ",option:"select",key:"valuationCode",filter:!0,optionsList:y(()=>g.value.vaCode)}]),Z=t(null),we={},$=t([]),w=t({});$.value=b.value.createFormRules(we,w);const Le=t([{name:"\u5E74\u5EA6",option:"input",key:"2"},{name:"\u5951\u7D04\u7DE8\u865F",option:"input",key:"4"},{name:"\u6A19\u6848\u540D\u7A31",option:"input",span:8,key:"6"}]),xe=t([{tip:"\u67E5\u8A62",type:"search",fun:()=>{}},{tip:"\u6E05\u7A7A",type:"clear",fun:()=>{w.value.name=""}},{tip:"\u9078\u53D6\u52A0\u5165",type:"",fun:()=>{if(F.value.length>0){C.value=!1;let s=ee.value.filter(e=>e.key==F.value);console.log(s[0])}}}]),Pe=re({page:1,pageCount:1,pageSize:25,onChange:s=>{w.value.currentPage=s}}),ee=t([{name:"testname",c:"testc",key:1},{name:"testname2",c:"testc",key:2},{name:"testname1",c:"testc",key:3}]),F=t([]),Ve=t([{type:"selection",multiple:!1},{title:"\u5E74\u5EA6",key:"name"},{title:"\u5951\u7D04\u7DE8\u865F",key:"name"},{title:"\u6A94\u6848\u540D\u7A31",key:"name"},{title:"\u63A1\u8CFC\u65B9\u5F0F",key:"name"}]),te=t(null),Oe={9:"req",10:"req"},ae=t([]),I=t({9:"",10:""});ae.value=b.value.createFormRules(Oe,I);const De=()=>{},Fe=()=>{p.value={2:""}},Ue=t([{name:"\u9810\u7B97\u4F86\u6E90\u5225\u4EE3\u865F",option:"select",key:"2",optionsList:l},{name:"\u5206\u652F\u8A08\u756B\u4EE3\u865F",option:"select",key:"2",optionsList:l},{name:"\u7528\u9014\u5225\u79D1\u76EE\u4EE3\u865F",option:"select",key:"2",optionsList:l},{name:"\u7D44\u5BA4",option:"select",key:"2",optionsList:l},{name:"\u6D41\u6C34\u865F",option:"",key:"5"},{name:"\u5951\u7D04\u7DE8\u865F",option:"",key:"5"}]),oe=t(null),Ne={9:"req",10:"req"},ne=t([]),B=t({9:"",10:""});ne.value=b.value.createFormRules(Ne,B);const Te=()=>{},Se=t([{name:"\u8A08\u5283\u7BA1\u7406\u670D\u52D9\u4EBA\u54E1",option:"select",key:"2",optionsList:l},{name:"\u696D\u52D9\u7D44\u627F\u8FA6\u4EBA",option:"",key:"2"},{name:"\u696D\u52D9\u7D44\u79D1\u9577",option:"select",key:"2",optionsList:l},{name:"\u8CC7\u8A0A\u5BA4\u627F\u8FA6\u4EBA",option:"select",key:"2",optionsList:l},{name:"\u8CC7\u8A0A\u5BA4\u6280\u6B63\u6216\u4E3B\u4EFB",option:"select",key:"2",optionsList:l},{name:"\u526F\u7D44\u9577",option:"select",key:"2",optionsList:l},{name:"\u7D44\u9577",option:"select",key:"2",optionsList:l}]),le=t(null),je={9:"req",10:"req"},se=t([]),E=t({9:"",10:""});se.value=b.value.createFormRules(je,E);const qe=()=>{},ze=()=>{},Ie=()=>{p.value={2:""}},Be=t([{name:"\u4E3B\u5F97\u6A19\u5EE0\u5546",option:"select",key:"2",optionsList:l,filter:!0},{name:"\u526F\u5F97\u6A19\u5EE0\u5546",option:"select",key:"2",optionsList:l,filter:!0},{name:"\u6C7A\u6A19\u65E5\u671F",option:"input",key:"2",optionsList:l},{name:"\u6C7A\u6A19\u91D1\u984D",option:"input",key:"2",optionsList:l},{name:"\u8A08\u756B\u5E33\u865F\u7533\u8ACB\u4EBA",option:"input",key:"5"}]);return(s,e)=>{const i=r("commonTitle"),m=r("commonForm"),U=r("n-data-table"),L=r("n-space"),N=r("n-layout"),f=r("commonBtn"),Ee=r("n-tooltip"),Me=r("n-gi"),ue=r("n-modal"),T=r("n-tab-pane"),Ae=r("n-tabs");return R(),pe(me,null,[o(i,null,{default:n(()=>[Je]),_:1}),o(m,{class:"mt-2",formRef:J.value,"onUpdate:formRef":e[0]||(e[0]=a=>J.value=a),formRules:Q.value,formOption:ge.value,formLabelPlacement:"top",xGap:40,modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=a=>u.value=a),span:4},null,8,["formRef","formRules","formOption","modelValue"]),o(U,{remote:"",columns:be.value,data:K.value,"single-line":!1,loading:O.value,"max-height":_(ye),pagination:k,"paginate-single-page":!1},null,8,["columns","data","loading","max-height","pagination"]),o(ue,{show:h.value,"onUpdate:show":e[14]||(e[14]=a=>h.value=a),preset:"card",class:"p-modal-body p-border",style:x({height:_(ve)})},{header:n(()=>[o(L,{class:"p-cardTitle"},{default:n(()=>[d("\u3000 "+M(v.value=="edit"?"\u4FEE\u6539":"\u65B0\u589E"),1)]),_:1})]),default:n(()=>[o(Ae,{type:"line","tab-style":{margin:" 0px 10px"},"default-value":"biddingPlan","tabs-padding":20,size:"small",animated:""},{default:n(()=>[o(T,{name:"biddingPlan",tab:"\u6A19\u6848\u8A08\u756B","display-directive":"show:lazy"},{default:n(()=>[o(N,{"native-scrollbar":!1,style:x({height:_(V)})},{default:n(()=>[o(m,{class:"mt-4 mx-4 px-4 pt-4",formRef:z.value,"onUpdate:formRef":e[2]||(e[2]=a=>z.value=a),formRules:X.value,formOption:Ce.value,formLabelWidth:170,modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=a=>p.value=a),span:24},null,8,["formRef","formRules","formOption","modelValue"])]),_:1},8,["style"]),o(L,{class:"mt-3",justify:"center"},{default:n(()=>[o(f,{type:"save",onClick:Re},{default:n(()=>[d(M(v.value=="edit"?"\u5132\u5B58":"\u65B0\u589E"),1)]),_:1}),o(f,{type:"clear",onClick:_e},{default:n(()=>[Qe]),_:1})]),_:1}),o(ue,{show:C.value,"onUpdate:show":e[7]||(e[7]=a=>C.value=a),title:"\u6A19\u6848\u8A08\u756B\u8CC7\u6599",preset:"card",style:{width:"75% !important"},class:"p-modal-body-h p-border"},{default:n(()=>[o(m,{formRef:Z.value,"onUpdate:formRef":e[4]||(e[4]=a=>Z.value=a),formRules:$.value,formOption:Le.value,formLabelPlacement:"top",xGap:40,modelValue:w.value,"onUpdate:modelValue":e[5]||(e[5]=a=>w.value=a),span:4},{default:n(()=>[o(Me,{span:6,class:"mt-4"},{default:n(()=>[(R(!0),pe(me,null,Ke(xe.value,(a,He)=>(R(),S(Ee,{key:He,trigger:"hover"},{trigger:n(()=>[o(f,{class:"mx-1 mb-1",type:a.type,onClick:a.fun},null,8,["type","onClick"])]),default:n(()=>[j("div",Xe,M(a.tip),1)]),_:2},1024))),128))]),_:1})]),_:1},8,["formRef","formRules","formOption","modelValue"]),o(U,{remote:"","checked-row-keys":F.value,"onUpdate:checked-row-keys":e[6]||(e[6]=a=>F.value=a),columns:Ve.value,data:ee.value,bordered:!1,pagination:Pe,"paginate-single-page":!1},null,8,["checked-row-keys","columns","data","pagination"])]),_:1},8,["show"])]),_:1}),v.value=="edit"?(R(),S(T,{key:0,name:"deedNumber",tab:"\u5951\u7D04\u7DE8\u865F","display-directive":"show:lazy"},{default:n(()=>[o(N,{"native-scrollbar":!1,style:x({height:_(V)})},{default:n(()=>[Ye,o(m,{class:"mt-4 mx-4 px-4 pt-4",formRef:te.value,"onUpdate:formRef":e[8]||(e[8]=a=>te.value=a),formRules:ae.value,formOption:Ue.value,formLabelWidth:150,modelValue:I.value,"onUpdate:modelValue":e[9]||(e[9]=a=>I.value=a),span:24},null,8,["formRef","formRules","formOption","modelValue"])]),_:1},8,["style"]),o(L,{class:"mt-3",justify:"center"},{default:n(()=>[o(f,{type:"",onClick:De},{default:n(()=>[Ze]),_:1}),o(f,{type:"clear",onClick:Fe},{default:n(()=>[$e]),_:1})]),_:1})]),_:1})):A("",!0),v.value=="edit"?(R(),S(T,{key:1,name:"censor",tab:"\u5BE9\u67E5\u4EBA\u54E1","display-directive":"show:lazy"},{default:n(()=>[o(N,{"native-scrollbar":!1,style:x({height:_(V)})},{default:n(()=>[o(m,{class:"mt-4 mx-4 px-4 pt-4",formRef:oe.value,"onUpdate:formRef":e[10]||(e[10]=a=>oe.value=a),formRules:ne.value,formOption:Se.value,formLabelWidth:150,modelValue:B.value,"onUpdate:modelValue":e[11]||(e[11]=a=>B.value=a),span:24},null,8,["formRef","formRules","formOption","modelValue"])]),_:1},8,["style"]),o(L,{class:"mt-3",justify:"center"},{default:n(()=>[o(f,{type:"save",onClick:Te},{default:n(()=>[et]),_:1})]),_:1})]),_:1})):A("",!0),v.value=="edit"?(R(),S(T,{key:2,name:"award",tab:"\u6C7A\u6A19\u8CC7\u8A0A","display-directive":"show:lazy"},{default:n(()=>[o(N,{"native-scrollbar":!1,style:x({height:_(V)})},{default:n(()=>[o(m,{class:"mt-4 mx-4 px-4 pt-4",formRef:le.value,"onUpdate:formRef":e[12]||(e[12]=a=>le.value=a),formRules:se.value,formOption:Be.value,formLabelWidth:150,modelValue:E.value,"onUpdate:modelValue":e[13]||(e[13]=a=>E.value=a),span:24},null,8,["formRef","formRules","formOption","modelValue"])]),_:1},8,["style"]),o(L,{class:"mt-3",justify:"center"},{default:n(()=>[o(f,{type:"save",onClick:qe},{default:n(()=>[tt]),_:1}),o(f,{type:"",onClick:ze},{default:n(()=>[at]),_:1}),o(f,{type:"clear",onClick:Ie},{default:n(()=>[ot]),_:1})]),_:1})]),_:1})):A("",!0)]),_:1})]),_:1},8,["show","style"])],64)}}};export{st as default};
