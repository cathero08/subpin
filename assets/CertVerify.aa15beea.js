import{a1 as h,r as y,a2 as g,s as m,o as v,b as k,d as f,e as a,i as l,t as _,m as w,D as S,F as C,S as c}from"./index.c91cc030.js";const P=""+new URL("sign.66c72186.gif",import.meta.url).href,u=h("storePki",()=>{const i=y({});return{certData:i,checkCertVerifyBackend:async e=>{console.log(e);try{const n=await g.post("cert/verify",{content:e.content.value,signedData:e.signedData.value,certCardNumber:e.certCardNumber.value,attributeCertData:e.attributeCertData.value,certSn:e.certSn.value,certSubject:e.certSubject.value,subjectSN:e.subjectSN.value,certBody:e.certBody.value,certOwnerName:e.certOwnerName.value,ownerId:e.ownerId.value,encrypCert:e.encrypCert});i.value=n.data}catch(n){console.log(n)}}}}),D=a("div",null,"testPage",-1),N=["onSubmit"],B=a("label",{for:"pin"},"\u6191\u8B49pin\u78BC",-1),x=a("input",{type:"password",name:"pin",id:"pin",size:"20",maxlength:"12"},null,-1),R=["value"],I=c('<input type="hidden" name="signedData" id="signedData"><input type="hidden" name="certCardNumber"><input type="hidden" name="attributeCertData"><input type="hidden" name="certSn"><input type="hidden" name="certSubject"><input type="hidden" name="subjectSN"><input type="hidden" name="certBody"><input type="hidden" name="certOwnerName"><input type="hidden" name="ownerId"><input type="hidden" name="encrypCert"><input type="submit" name="sign" value="\u9001\u51FA">',11),b=c('<div id="blockUIDiv" style="display:none;position:fixed;z-index:99;top:0px;left:0px;_position:absolute;_top:expression(;"><div align="center"><img src="'+P+'"><div>\u8655\u7406\u4E2D...</div></div><div align="right" style="position:absolute;right:30px;bottom:30px;"> \u5C55\u4FE1\u8CC7\u8A0A\u6709\u9650\u516C\u53F8<br><a href="http://www.zhaninfo.com" target="_blank">http://www.zhaninfo.com</a></div></div>',1),V={__name:"CertVerify",props:{certData:String},setup(i){const{checkCertVerifyBackend:o}=u(),{certData:e}=m(u()),n=async()=>{let t=document.querySelector("form");await p(t,new Array(1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17))};function r(){checkEnvir(),setTimeout(function(){getChtPkiReady()?isPkiInstalled(document.getElementById("Pkcs7Sign"),!1):isPkiInstalled(document.getElementById("Pkcs7Sign"),!0)},500)}v(()=>{r()}),document.addEventListener?window.addEventListener("load",r,!1):window.attachEvent("onload",r);async function p(t,s){if(getPkiReady()==!1&&getChtPkiReady()==!1)return!1;var d=t.content.value;return(d==null||d.length==0)&&location.reload(),t.pin==null||t.pin.value.length==0?(alert("\u6191\u8B49PIN\u78BC(\u5BC6\u78BC) \u4E0D\u80FD\u70BA\u7A7A\u767D"),!1):t.pin.value.length<6||t.pin.value.length>12?(alert(`\u6191\u8B49\u5BC6\u78BC\u53EA\u5141\u8A316-12\u78BC\uFF0C\u8ACB\u78BA\u8A8D\u8F38\u5165\u7684\u6191\u8B49\u5BC6\u78BC\u662F\u5426\u6B63\u78BA\uFF0C
\u82E5\u60A8\u7684\u5BC6\u78BC\u975E6-12\u78BC\uFF0C\u8ACB\u81F3\u5404\u6191\u8B49\u7BA1\u7406\u4E2D\u5FC3\u4FEE\u6539\u6191\u8B49\u5BC6\u78BC`),!1):(await setTargetForm(t),showBlockUI(),getPkiReady()?(await onSignPki(s,o),setTimeout(function(){pkiResult.errorCode!=0&&pkiResult.errorCode!=-250609662&&pkiResult.errorCode!=-250609661&&pkiResult.errorCode!=-250609656&&pkiResult.errorCode!=-250609655&&runMoicaPkiSign()},2e3)):runMoicaPkiSign(),!1)}return(t,s)=>(k(),f(C,null,[D,a("form",{name:"certLogin",onSubmit:_(n,["prevent"])},[B,x,a("input",{type:"hidden",name:"content",id:"content",value:l(e)},null,8,R),I],40,N),w(" certData: "+S(l(e))+" ",1),b],64))}};export{V as default};
